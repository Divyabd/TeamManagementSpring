pipeline{
  agent {
    docker{
       image 'maven:3.6.3-jdk-11'
      args '-v /root/.m2:/root/.m2'
    }
  }
  
  stages {
    stage('maven validate'){
        steps{
          sh 'mvn validate'
        }
    }


    stage('maven compile'){
        steps{
          sh 'mvn compile'
        }
    }

   


    stage("build & SonarQube analysis") {
  
            steps {
              withSonarQubeEnv('sonarcloud') {
               
                sh 'mvn verify sonar:sonar'
              }
            }
              post{
       failure{
           mail bcc: '', body: 'build & SonarQube analysis stage fails ', cc: '', from: '', replyTo: '', subject: 'build & SonarQube analysis step fails', to: 'divyagowdadivya238@gmail.com'
        }
                
           
     }
          }
          
    stage('maven package'){
        steps{
          sh 'mvn package'
        }
    }
    
     
       
      
  
  }
  }

